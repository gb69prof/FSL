<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Campi Diomedei — Scopri Foggia</title>
  <style>
    :root{
      --bg0:#0b1020; --bg1:#0e1731;
      --card:rgba(255,255,255,.07);
      --stroke:rgba(255,255,255,.14);
      --txt:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.70);
      --accent:#ffb347; --accent2:#ff5f2e;
      --shadow: 0 18px 45px rgba(0,0,0,.45);
      --radius:22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Helvetica, sans-serif;
      color:var(--txt);
      background:
        radial-gradient(1200px 600px at 18% 8%, rgba(255,179,71,.14), transparent 55%),
        radial-gradient(900px 500px at 78% 18%, rgba(255,95,46,.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      min-height:100vh;
      padding:18px;
    }
    header{
      max-width:1200px;
      margin:0 auto 14px auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 10px 12px;
      border-radius: 18px;
      background: rgba(0,0,0,.16);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .brand{display:flex;flex-direction:column;align-items:flex-start;gap:2px}
    .brand h1{margin:0;font-size:clamp(18px,2.2vw,28px);letter-spacing:.3px}
    .brand small{color:var(--muted)}
    .homebtn{
      text-decoration:none;color:var(--txt);font-size:13px;
      padding:10px 12px;border-radius:999px;border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
      transition: transform .18s ease, border-color .18s ease;
      display:inline-flex;align-items:center;gap:8px;
      white-space:nowrap;
    }
    .homebtn:hover{transform:translateY(-1px);border-color:rgba(255,179,71,.45)}

    main{
      max-width:1200px;
      margin: 0 auto;
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      grid-template-rows: 420px 1fr;
      gap:14px;
    }
    .panel{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
    }
    #area1{grid-column:1;grid-row:1}
    #areaIcons{grid-column:1;grid-row:2}
    #area2{grid-column:2;grid-row:1 / span 2}

    .panel-header{
      display:flex;align-items:center;justify-content:space-between;
      padding:12px 14px;border-bottom:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,0));
    }
    .panel-title{font-weight:800;font-size:14px;letter-spacing:.2px}
    .chip{
      font-size:12px;color:rgba(255,255,255,.82);
      border:1px solid rgba(255,179,71,.35);
      background:linear-gradient(135deg, rgba(255,179,71,.18), rgba(255,95,46,.12));
      padding:6px 10px;border-radius:999px;white-space:nowrap;
    }

    .viewer{
      height: calc(100% - 49px);
      width: 100%;
      background: rgba(0,0,0,.15);
      position:relative;
    }
    .viewer iframe{
      width:100%; height:100%; border:0; display:block;
      filter: saturate(1.05) contrast(1.02);
    }

    .slider{
      height:100%;
      width:100%;
      display:none;
      position:relative;
      overflow:hidden;
      background: rgba(0,0,0,.15);
    }
    .slide{
      height:100%;
      width:100%;
      display:none;
      object-fit:contain;
      background: rgba(0,0,0,.15);
    }
    .slide.active{display:block}
    .slider-controls{
      position:absolute;
      bottom:12px; left:12px; right:12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      pointer-events:none;
    }
    .ctrl-btn{
      pointer-events:auto;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.35);
      color: var(--txt);
      padding:10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight:800;
      transition: transform .18s ease, border-color .18s ease;
      user-select:none;
    }
    .ctrl-btn:hover{transform:translateY(-1px);border-color:rgba(255,179,71,.45)}
    .dots{
      pointer-events:auto;
      display:flex; gap:6px; justify-content:center; align-items:center;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.28);
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: rgba(255,255,255,.28);
      cursor:pointer;
    }
    .dot.active{background: linear-gradient(135deg, rgba(255,179,71,.95), rgba(255,95,46,.92));}

    .textwrap{
      height: calc(100% - 49px);
      padding:14px 14px 18px 14px;
      overflow:auto;line-height:1.6;color:rgba(255,255,255,.90);
      scrollbar-width: thin;
      scrollbar-color: rgba(255,179,71,.35) rgba(255,255,255,.08);
    }
    .textwrap::-webkit-scrollbar{width:10px}
    .textwrap::-webkit-scrollbar-track{background:rgba(255,255,255,.08);border-radius:999px}
    .textwrap::-webkit-scrollbar-thumb{
      background:linear-gradient(180deg, rgba(255,179,71,.55), rgba(255,95,46,.45));
      border-radius:999px
    }
    .textwrap h2{margin:0 0 10px 0;font-size:18px}
    .textwrap p{margin:0 0 10px 0;color:rgba(255,255,255,.86)}
    .hint{
      color:rgba(255,255,255,.66);
      font-size:12px;border-top:1px dashed rgba(255,255,255,.18);
      padding-top:10px;margin-top:10px
    }

    .iconsbar{
      height:100%;
      padding: 14px;
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      align-content:start;
    }
    .iconbtn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      border-radius: 18px;
      padding: 14px 12px;
      cursor:pointer;
      text-align:left;
      transition: transform .18s ease, border-color .18s ease, background .18s ease;
      display:flex;
      gap:10px;
      align-items:center;
      min-height:64px;
    }
    .iconbtn:hover{
      transform: translateY(-2px);
      border-color: rgba(255,179,71,.45);
      background: rgba(0,0,0,.24);
    }
    .badge{
      width:40px; height:40px;
      border-radius: 16px;
      display:grid; place-items:center;
      font-weight:900;
      color:#121212;
      background: linear-gradient(135deg, rgba(255,179,71,.95), rgba(255,95,46,.92));
      box-shadow: 0 10px 20px rgba(0,0,0,.35);
      flex: 0 0 auto;
    }
    .iconlbl{display:flex;flex-direction:column;gap:2px;min-width:0}
    .iconlbl strong{font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .iconlbl span{font-size:12px;color:rgba(255,255,255,.70)}
    .iconbtn.active{
      border-color: rgba(255,179,71,.65);
      background: rgba(255,179,71,.10);
    }

    @media (max-width: 980px){
      main{grid-template-columns:1fr;grid-template-rows: 380px auto auto}
      #area1{grid-column:1;grid-row:1}
      #areaIcons{grid-column:1;grid-row:2}
      #area2{grid-column:1;grid-row:3}
      .iconsbar{grid-template-columns:1fr 1fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <h1>Campi Diomedei</h1>
      <small>Scopri Foggia — pagina luogo</small>
    </div>
    <a class="homebtn" href="../index.html">⟵ Home</a>
  </header>

  <main>
    <section id="area1" class="panel" aria-label="Sezione 1">
      <div class="panel-header">
        <div class="panel-title">1 — Visualizza</div>
        <div class="chip" id="chip1">Mappa</div>
      </div>

      <div class="viewer" id="viewer">
        <iframe id="mapFrame"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=41.45748,15.56126&z=17&output=embed"
          title="Campi Diomedei — mappa"></iframe>

        <div class="slider" id="slider" aria-label="Galleria immagini">
          <img class="slide active" src="imm/1.jpg" alt="Immagine 1">
          <img class="slide" src="imm/2.jpg" alt="Immagine 2">
          <img class="slide" src="imm/3.jpg" alt="Immagine 3">
          <img class="slide" src="imm/4.jpg" alt="Immagine 4">

          <div class="slider-controls">
            <button class="ctrl-btn" id="prevBtn" type="button">⟵</button>
            <div class="dots" id="dots"></div>
            <button class="ctrl-btn" id="nextBtn" type="button">⟶</button>
          </div>
        </div>
      </div>
    </section>

    <section id="areaIcons" class="panel" aria-label="Sezione icone">
      <div class="panel-header">
        <div class="panel-title">3–6 — Azioni</div>
        <div class="chip">clicca</div>
      </div>

      <div class="iconsbar">
        <button class="iconbtn" id="btnVideo" type="button">
          <div class="badge">3</div>
          <div class="iconlbl"><strong>Video</strong><span>apri in sezione 1</span></div>
        </button>

        <button class="iconbtn" id="btnImmagini" type="button">
          <div class="badge">4</div>
          <div class="iconlbl"><strong>Immagini</strong><span>galleria scorrevole</span></div>
        </button>

        <button class="iconbtn" id="btnVivi" type="button">
          <div class="badge">5</div>
          <div class="iconlbl"><strong>Vivi</strong><span>testo alternativo</span></div>
        </button>

        <button class="iconbtn" id="btnAppro" type="button">
          <div class="badge">6</div>
          <div class="iconlbl"><strong>Approfondimento</strong><span>testo esteso</span></div>
        </button>
      </div>
    </section>

    <section id="area2" class="panel" aria-label="Sezione 2 testo">
      <div class="panel-header">
        <div class="panel-title">2 — Testo</div>
        <div class="chip" id="chip2">diomedee.txt</div>
      </div>
      <div class="textwrap" id="textBox">
        <h2>Caricamento…</h2>
        <p>Sto leggendo <strong>diomedee.txt</strong>.</p>
      </div>
    </section>
  </main>

  <script>
    const MAP_URL = "https://www.google.com/maps?q=41.45748,15.56126&z=17&output=embed";
    const YT_EMBED = "https://www.youtube.com/embed/jQPxf3NOF0w";

    const chip1 = document.getElementById('chip1');
    const chip2 = document.getElementById('chip2');

    const mapFrame = document.getElementById('mapFrame');
    const slider = document.getElementById('slider');

    const btnVideo = document.getElementById('btnVideo');
    const btnImmagini = document.getElementById('btnImmagini');
    const btnVivi = document.getElementById('btnVivi');
    const btnAppro = document.getElementById('btnAppro');

    function setActive(btn){
      [btnVideo, btnImmagini, btnVivi, btnAppro].forEach(b => b.classList.remove('active'));
      if(btn) btn.classList.add('active');
    }

    function showMap(){
      slider.style.display = "none";
      mapFrame.style.display = "block";
      mapFrame.src = MAP_URL;
      chip1.textContent = "Mappa";
    }
    function showVideo(){
      slider.style.display = "none";
      mapFrame.style.display = "block";
      mapFrame.src = YT_EMBED;
      chip1.textContent = "Video";
    }
    function showImages(){
      mapFrame.style.display = "none";
      slider.style.display = "block";
      chip1.textContent = "Immagini";
    }

    async function loadTxt(filename){
      const box = document.getElementById('textBox');
      chip2.textContent = filename;
      try{
        const res = await fetch(filename, { cache: 'no-cache' });
        if(!res.ok) throw new Error("Impossibile leggere " + filename);

        const txt = await res.text();
        const parts = txt.replace(/\r/g,'').split(/\n\s*\n/).map(p => p.trim()).filter(Boolean);

        let html = parts.map(p => `<p>${escapeHtml(p).replace(/\n/g,'<br>')}</p>`).join('');
        html += `<div class="hint">Titoli: se una riga è tutta MAIUSCOLA, la trasformo in titolo.</div>`;
        box.innerHTML = html;
        box.innerHTML = box.innerHTML.replace(/<p>([A-ZÀ-Ü0-9\s'’.,:-]{8,})<\/p>/g, '<h2>$1</h2>');
      }catch(err){
        box.innerHTML = `<h2>Errore</h2><p>${escapeHtml(err.message)}</p>`;
      }
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }

    // Slider
    const slides = Array.from(document.querySelectorAll('.slide'));
    const dots = document.getElementById('dots');
    let idx = 0;

    function renderDots(){
      dots.innerHTML = "";
      slides.forEach((_, i) => {
        const d = document.createElement('div');
        d.className = "dot" + (i===idx ? " active" : "");
        d.addEventListener('click', () => goTo(i));
        dots.appendChild(d);
      });
    }
    function goTo(i){
      idx = (i + slides.length) % slides.length;
      slides.forEach((s, j) => s.classList.toggle('active', j===idx));
      renderDots();
    }
    document.getElementById('prevBtn').addEventListener('click', () => goTo(idx-1));
    document.getElementById('nextBtn').addEventListener('click', () => goTo(idx+1));
    renderDots();

    // Buttons
    btnVideo.addEventListener('click', () => { setActive(btnVideo); showVideo(); });
    btnImmagini.addEventListener('click', () => { setActive(btnImmagini); showImages(); });
    btnVivi.addEventListener('click', () => { setActive(btnVivi); loadTxt('vivi.txt'); });
    btnAppro.addEventListener('click', () => { setActive(btnAppro); loadTxt('approfondimento.txt'); });

    // Init
    showMap();
    loadTxt('diomedee.txt');
  </script>
</body>
</html>
